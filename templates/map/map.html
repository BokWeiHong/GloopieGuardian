{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <link rel="stylesheet" href="{% static 'css/retro.css' %}">
   <link rel="stylesheet" href="{% static 'css/leaflet.css' %}">
   <link rel="icon" type="image/x-icon" href="{% static 'images/favicon.ico' %}">
   <title>GloopieGuardian</title>
</head>

<body class="retro">
   {% include "components/navbar.html" %}
   
   <div class="window">
      <div class="window-titlebar">
         <span class="window-title">Select Your Scans</span>
         <div class="window-buttons">
            <span class="btn pixel minimize"></span>
            <span class="btn pixel square"></span>
            <span class="btn pixel close"></span>
         </div>
      </div>
      <div class="window-content">
         <div class="select-header">
            <label><input type="checkbox" id="selectAll">Select All</label>
         </div>
         <select id="scanSelector" multiple size="5"></select>
         <span style="font-size: 8px; margin: 0.5rem;">*Drag to select multiple scans</span>
      </div>
      <div class="window-footer">
         <input type="text" class="window-input" id="selectedScans" placeholder="No scans selected..." readonly />
         <button class="window-btn" id="applyFilters">Apply Filters</button>
      </div>
   </div>

   <div class="window" style="height: 750px; margin-top: 1rem;">
      <div class="window-titlebar">
         <span class="window-title">Available SSID</span>
         <div id="gpsDisplay" style="display: flex; align-items: center; gap: 15px; font-size: 12px;">
            <span id="gpsLat">Lat: --</span>
            <span id="gpsLon">Lon: --</span>
         </div>
      </div>
      <div class="window-content" style="padding: 0; height: calc(100% - 35px);">
         <div id="map"></div>
      </div>
   </div>

   <div class="window">
      <div class="window-titlebar">
         <span class="window-title">Tactical Signal Radar</span>
         
         <select id="rangeSelector" class="window-select">
            <option value="2">Range: 2m</option>
            <option value="5">Range: 5m</option>
            <option value="10" selected>Range: 10m</option>
            <option value="25">Range: 25m</option>
            <option value="50">Range: 50m</option>
            <option value="100">Range: 100m</option>
         </select>
      </div>

      <div class="window-content radar-content">
         <div class="radar-left">
            <canvas id="radarCanvas"></canvas>
         </div>
         <div class="radar-right">
            <table class="styledTable" id="radarTable">
               <thead>
                  <tr>
                     <th>SSID</th>
                     <th>MAC</th>
                     <th>SIG</th>
                     <th>DIST</th>
                  </tr>
               </thead>
               <tbody>
                  </tbody>
            </table>
         </div>
      </div>
   </div>

   <div class="window">
      <div class="window-titlebar">
         <span class="window-title">AP-to-Client Mapping</span>
         <select id="apSelector" class="window-select" style="margin-right: 10px;">
            <option value="">All</option>
         </select>
      </div>

      <div class="window-content window-graph-content" style="display: flex; gap: 10px; height: 100%;">
         
         <!-- Graph -->
         <div class="visual-pane" style="flex: none; position: relative;">
            <div id="cy"></div>

            <div class="graph-legend">
               <span class="legend-item"><i class="ap-icon"></i> AP</span>
               <span class="legend-item"><i class="client-icon"></i> Client</span>
            </div>
         </div>

         <div class="data-pane" style="flex: 1; overflow-y: auto;">
            <p>Detected Associations</p>

            <table class="styledTable" id="associationTable">
               <thead>
                  <tr>
                     <th>AP</th>
                     <th>Client</th>
                     <th>Type</th>
                  </tr>
               </thead>
               <tbody>
                  <!-- Filled by JavaScript -->
               </tbody>
            </table>
         </div>

      </div>
   </div>


   <div id="alertMap" class="alert hidden">
      <div class="alert-title">Connection Lost</div>
      <div class="alert-message">Internet connection required to load map tiles.</div>
      <button class="alert-btn" onclick="closeAlert()">OK</button>
   </div>

   {% include "components/footer.html" %}

   <script src="{% static 'js/chart.umd.min.js' %}"></script>
   <script src="{% static 'js/cytoscape.min.js' %}"></script>
   <script src="{% static 'js/retro.js' %}"></script>
   <script src="{% static 'js/leaflet.js' %}"></script>
   <script src="{% static 'js/map.js' %}"></script>

</body>
</html>